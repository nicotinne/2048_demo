{"version":3,"sources":["gameOverHandle.js"],"names":["User","require","emitter","db","JSON","parse","cc","sys","localStorage","getItem","Class","extends","Component","properties","edbUsername","EditBox","btnSubmit","Button","lblScore","Label","phaoBong","Node","openGameOver","clickSubmit","users","onLoad","doOpenGameOver","bind","instance","registerEvent","start","checkData","node","on","doSubmit","totalScore","log","active","countScore","actions","callFunc","delayTime","string","runAction","repeat","sequence","getInfoUserAndPushToArray","user","name","score","push","setItem","stringify","emit"],"mappings":";;;;;;AACA,IAAMA,OAAOC,QAAQ,MAAR,CAAb;AACA,IAAMC,UAAUD,QAAQ,UAAR,CAAhB;AACA,IAAME,KAAKC,KAAKC,KAAL,CAAWC,GAAGC,GAAH,CAAOC,YAAP,CAAoBC,OAApB,CAA4B,OAA5B,CAAX,CAAX;AACAH,GAAGI,KAAH,CAAS;AACLC,aAASL,GAAGM,SADP;;AAGLC,gBAAY;AACRC,qBAAaR,GAAGS,OADR;AAERC,mBAAWV,GAAGW,MAFN;AAGRC,kBAAUZ,GAAGa,KAHL;AAIRC,kBAAUd,GAAGe,IAJL;;AAMRC,sBAAc,IANN;AAORC,qBAAa,IAPL;AAQRC,eAAO;AARC,KAHP;;AAcL;AACAC,UAfK,oBAeK;AACN,aAAKH,YAAL,GAAoB,KAAKI,cAAL,CAAoBC,IAApB,CAAyB,IAAzB,CAApB;AACAzB,gBAAQ0B,QAAR,CAAiBC,aAAjB,CAA+B,eAA/B,EAAgD,KAAKP,YAArD;AACH,KAlBI;AAoBLQ,SApBK,mBAoBI;AACL,aAAKC,SAAL;AACA,aAAKf,SAAL,CAAegB,IAAf,CAAoBC,EAApB,CAAuB,OAAvB,EAAgC,KAAKC,QAArC,EAA+C,IAA/C;AAEH,KAxBI;AA0BLR,kBA1BK,0BA0BUS,UA1BV,EA0BsB;AAAA;;AACvB7B,WAAG8B,GAAH,CAAOD,UAAP;AACA,aAAKH,IAAL,CAAUK,MAAV,GAAmB,IAAnB;AACA,YAAIC,aAAa,CAAjB;AACA,YAAIC,UAAU,CAACjC,GAAGkC,QAAH,CAAY,YAAM;AAC7BF,0BAAc,CAAd;AACA,gBAAGA,cAAcH,UAAjB,EAA6B;AACzB,sBAAKf,QAAL,CAAciB,MAAd,GAAuB,IAAvB;AACH;AACJ,SALc,CAAD,EAMd/B,GAAGmC,SAAH,CAAa,KAAb,CANc,EAOdnC,GAAGkC,QAAH,CAAY,YAAM;AAAE,kBAAKtB,QAAL,CAAcwB,MAAd,GAAuBJ,UAAvB;AAAkC,SAAtD,CAPc,CAAd;AAQA,aAAKpB,QAAL,CAAcc,IAAd,CAAmBW,SAAnB,CAA6BrC,GAAGsC,MAAH,CAAUtC,GAAGuC,QAAH,CAAYN,OAAZ,CAAV,EAAgCJ,UAAhC,CAA7B;AAEH,KAxCI;AA0CLW,6BA1CK,uCA0CuB;AACxB,YAAIC,OAAO,IAAI/C,IAAJ,EAAX;AACA+C,aAAKC,IAAL,GAAY,KAAKlC,WAAL,CAAiB4B,MAA7B;AACAK,aAAKE,KAAL,GAAa,KAAK/B,QAAL,CAAcwB,MAA3B;AACA,aAAKlB,KAAL,CAAW0B,IAAX,CAAgBH,IAAhB;AACH,KA/CI;AAiDLb,YAjDK,sBAiDM;AACP,YAAG,KAAKpB,WAAL,CAAiB4B,MAAjB,IAA2B,EAA9B,EAAkC;AAClC,aAAKI,yBAAL;AACA,YAAG,KAAKtB,KAAL,IAAc,IAAjB,EAAuB;AACnBlB,eAAGC,GAAH,CAAOC,YAAP,CAAoB2C,OAApB,CAA4B,OAA5B,EAAqC/C,KAAKgD,SAAL,CAAe,KAAK5B,KAApB,CAArC;AACH;AACD,aAAKV,WAAL,CAAiB4B,MAAjB,GAA0B,EAA1B;AACAxC,gBAAQ0B,QAAR,CAAiByB,IAAjB,CAAsB,gBAAtB,EAAwC,KAAKrB,IAA7C;AACH,KAzDI;AA2DLD,aA3DK,uBA2DO;AACR,YAAG5B,MAAM,IAAT,EAAe;AACX,iBAAKqB,KAAL,GAAarB,EAAb;AACH;AACJ;AA/DI;AAgEL;AAhEJ","file":"gameOverHandle.js","sourceRoot":"../../../../../assets/Script/Handle","sourcesContent":["\nconst User = require(\"User\");\nconst emitter = require(\"mEmitter\");\nconst db = JSON.parse(cc.sys.localStorage.getItem(\"users\"));\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        edbUsername: cc.EditBox,\n        btnSubmit: cc.Button,\n        lblScore: cc.Label,\n        phaoBong: cc.Node,\n\n        openGameOver: null,\n        clickSubmit: null,\n        users: [],\n    },\n\n    // LIFE-CYCLE CALLBACKS:\n    onLoad () {\n        this.openGameOver = this.doOpenGameOver.bind(this);\n        emitter.instance.registerEvent(\"OPEN_GAMEOVER\", this.openGameOver);\n    },\n\n    start () {\n        this.checkData();\n        this.btnSubmit.node.on(\"click\", this.doSubmit, this);\n        \n    },\n\n    doOpenGameOver(totalScore) {\n        cc.log(totalScore)\n        this.node.active = true;\n        let countScore = 0;\n        let actions = [cc.callFunc(() => { \n            countScore += 1;\n            if(countScore == totalScore) {\n                this.phaoBong.active = true;\n            }\n        }),\n        cc.delayTime(0.001),\n        cc.callFunc(() => { this.lblScore.string = countScore})];\n        this.lblScore.node.runAction(cc.repeat(cc.sequence(actions), totalScore));\n        \n    },\n\n    getInfoUserAndPushToArray() {\n        let user = new User();\n        user.name = this.edbUsername.string;\n        user.score = this.lblScore.string;\n        this.users.push(user);\n    },\n\n    doSubmit() {\n        if(this.edbUsername.string == \"\") return;\n        this.getInfoUserAndPushToArray();\n        if(this.users != null) {\n            cc.sys.localStorage.setItem(\"users\", JSON.stringify(this.users));\n        }\n        this.edbUsername.string = \"\";\n        emitter.instance.emit(\"CLOSE_GAMEOVER\", this.node);\n    },\n\n    checkData() {\n        if(db != null) {\n            this.users = db;\n        }\n    },\n    // update (dt) {},\n});\n"]}